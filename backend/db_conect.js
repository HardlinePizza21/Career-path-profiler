import { MongoClient, ServerApiVersion } from 'mongodb';
import dotenv from 'dotenv';

dotenv.config(); // Load environment variables from .env file

const uri = process.env.MONGOURI;

// Create a MongoClient with a MongoClientOptions object to set the Stable API version
const client = new MongoClient(uri);

async function run() {
    try {

        // Connect the client to the server	(optional starting in v4.7)
        await client.connect();

        // Send a ping to confirm a successful connection
        await client.db("admin").command({ ping: 1 });
        console.log("Pinged your deployment. You successfully connected to MongoDB!");


        //Example of how to use the client to interact with a database and collection
        const database = client.db('sample_mflix');
        const movies = database.collection('embedded_movies');

        // Query for a movie that has the title 'Back to the Future'
        // const query = { title: 'Back to the Future' };
        // const movie = await movies.findOne(query);
        // console.log(movie);

        // Get a list of the collection's search indexes and print them
        // const cursor = movies.listIndexes();
        // for await (const index of cursor) {
        //   console.log(index);
        // }

        //vector search example with ANN (approximated nearest neighbors)
        // define pipeline
        // const agg = [
        //     {
        //         '$vectorSearch': {
        //             'index': 'movies',
        //             'path': 'plot_embedding',
                    // 'queryVector': [
                    //     -0.0016261312, -0.028070757, -0.011342932, -0.012775794, -0.0027440966, 0.008683807, -0.02575152, -0.02020668, -0.010283281, -0.0041719596, 0.021392956, 0.028657231, -0.006634482, 0.007490867, 0.018593878, 0.0038187427, 0.029590257, -0.01451522, 0.016061379, 0.00008528442, -0.008943722, 0.01627464, 0.024311995, -0.025911469, 0.00022596726, -0.008863748, 0.008823762, -0.034921836, 0.007910728, -0.01515501, 0.035801545, -0.0035688248, -0.020299982, -0.03145631, -0.032256044, -0.028763862, -0.0071576433, -0.012769129, 0.012322609, -0.006621153, 0.010583182, 0.024085402, -0.001623632, 0.007864078, -0.021406285, 0.002554159, 0.012229307, -0.011762793, 0.0051682983, 0.0048484034, 0.018087378, 0.024325324, -0.037694257, -0.026537929, -0.008803768, -0.017767483, -0.012642504, -0.0062712682, 0.0009771782, -0.010409906, 0.017754154, -0.004671795, -0.030469967, 0.008477209, -0.005218282, -0.0058480743, -0.020153364, -0.0032805866, 0.004248601, 0.0051449724, 0.006791097, 0.007650814, 0.003458861, -0.0031223053, -0.01932697, -0.033615597, 0.00745088, 0.006321252, -0.0038154104, 0.014555207, 0.027697546, -0.02828402, 0.0066711367, 0.0077107945, 0.01794076, 0.011349596, -0.0052715978, 0.014755142, -0.019753495, -0.011156326, 0.011202978, 0.022126047, 0.00846388, 0.030549942, -0.0041386373, 0.018847128, -0.00033655585, 0.024925126, -0.003555496, -0.019300312, 0.010749794, 0.0075308536, -0.018287312, -0.016567878, -0.012869096, -0.015528221, 0.0078107617, -0.011156326, 0.013522214, -0.020646535, -0.01211601, 0.055928253, 0.011596181, -0.017247654, 0.0005939711, -0.026977783, -0.003942035, -0.009583511, -0.0055248477, -0.028737204, 0.023179034, 0.003995351, 0.0219661, -0.008470545, 0.023392297, 0.010469886, -0.015874773, 0.007890735, -0.009690142, -0.00024970944, 0.012775794, 0.0114762215, 0.013422247, 0.010429899, -0.03686786, -0.006717788, -0.027484283, 0.011556195, -0.036068123, -0.013915418, -0.0016327957, 0.0151016945, -0.020473259, 0.004671795, -0.012555866, 0.0209531, 0.01982014, 0.024485271, 0.0105431955, -0.005178295, 0.033162415, -0.013795458, 0.007150979, 0.010243294, 0.005644808, 0.017260984, -0.0045618312, 0.0024725192, 0.004305249, -0.008197301, 0.0014203656, 0.0018460588, 0.005015015, -0.011142998, 0.01439526, 0.022965772, 0.02552493, 0.007757446, -0.0019726837, 0.009503538, -0.032042783, 0.008403899, -0.04609149, 0.013808787, 0.011749465, 0.036388017, 0.016314628, 0.021939443, -0.0250051, -0.017354285, -0.012962398, 0.00006107364, 0.019113706, 0.03081652, -0.018114036, -0.0084572155, 0.009643491, -0.0034721901, 0.0072642746, -0.0090636825, 0.01642126, 0.013428912, 0.027724205, 0.0071243206, -0.6858542, -0.031029783, -0.014595194, -0.011449563, 0.017514233, 0.01743426, 0.009950057, 0.0029706885, -0.015714826, -0.001806072, 0.011856096, 0.026444625, -0.0010663156, -0.006474535, 0.0016161345, -0.020313311, 0.0148351155, -0.0018393943, 0.0057347785, 0.018300641, -0.018647194, 0.03345565, -0.008070676, 0.0071443142, 0.014301958, 0.0044818576, 0.003838736, -0.007350913, -0.024525259, -0.001142124, -0.018620536, 0.017247654, 0.007037683, 0.010236629, 0.06046009, 0.0138887605, -0.012122675, 0.037694257, 0.0055081863, 0.042492677, 0.00021784494, -0.011656162, 0.010276617, 0.022325981, 0.005984696, -0.009496873, 0.013382261, -0.0010563189, 0.0026507939, -0.041639622, 0.008637156, 0.026471283, -0.008403899, 0.024858482, -0.00066686375, -0.0016252982, 0.027590916, 0.0051449724, 0.0058647357, -0.008743787, -0.014968405, 0.027724205, -0.011596181, 0.0047650975, -0.015381602, 0.0043718936, 0.002159289, 0.035908177, -0.008243952, -0.030443309, 0.027564257, 0.042625964, -0.0033688906, 0.01843393, 0.019087048, 0.024578573, 0.03268257, -0.015608194, -0.014128681, -0.0033538956, -0.0028757197, -0.004121976, -0.032389335, 0.0034322033, 0.058807302, 0.010943064, -0.030523283, 0.008903735, 0.017500903, 0.00871713, -0.0029406983, 0.013995391, -0.03132302, -0.019660193, -0.00770413, -0.0038853872, 0.0015894766, -0.0015294964, -0.006251275, -0.021099718, -0.010256623, -0.008863748, 0.028550599, 0.02020668, -0.0012962399, -0.003415542, -0.0022509254, 0.0119360695, 0.027590916, -0.046971202, -0.0015194997, -0.022405956, 0.0016677842, -0.00018535563, -0.015421589, -0.031802863, 0.03814744, 0.0065411795, 0.016567878, -0.015621523, 0.022899127, -0.011076353, 0.02841731, -0.002679118, -0.002342562, 0.015341615, 0.01804739, -0.020566562, -0.012989056, -0.002990682, 0.01643459, 0.00042527664, 0.008243952, -0.013715484, -0.004835075, -0.009803439, 0.03129636, -0.021432944, 0.0012087687, -0.015741484, -0.0052016205, 0.00080890034, -0.01755422, 0.004811749, -0.017967418, -0.026684547, -0.014128681, 0.0041386373, -0.013742141, -0.010056688, -0.013268964, -0.0110630235, -0.028337335, 0.015981404, -0.00997005, -0.02424535, -0.013968734, -0.028310679, -0.027750863, -0.020699851, 0.02235264, 0.001057985, 0.00081639783, -0.0099367285, 0.013522214, -0.012016043, -0.00086471526, 0.013568865, 0.0019376953, -0.019020405, 0.017460918, -0.023045745, 0.008503866, 0.0064678704, -0.011509543, 0.018727167, -0.003372223, -0.0028690554, -0.0027024434, -0.011902748, -0.012182655, -0.015714826, -0.0098634185, 0.00593138, 0.018753825, 0.0010146659, 0.013029044, 0.0003521757, -0.017620865, 0.04102649, 0.00552818, 0.024485271, -0.009630162, -0.015608194, 0.0006718621, -0.0008418062, 0.012395918, 0.0057980907, 0.016221326, 0.010616505, 0.004838407, -0.012402583, 0.019900113, -0.0034521967, 0.000247002, -0.03153628, 0.0011038032, -0.020819811, 0.016234655, -0.00330058, -0.0032289368, 0.00078973995, -0.021952773, -0.022459272, 0.03118973, 0.03673457, -0.021472929, 0.0072109587, -0.015075036, 0.004855068, -0.0008151483, 0.0069643734, 0.010023367, -0.010276617, -0.023019087, 0.0068244194, -0.0012520878, -0.0015086699, 0.022046074, -0.034148756, -0.0022192693, 0.002427534, -0.0027124402, 0.0060346797, 0.015461575, 0.0137554705, 0.009230294, -0.009583511, 0.032629255, 0.015994733, -0.019167023, -0.009203636, 0.03393549, -0.017274313, -0.012042701, -0.0009930064, 0.026777849, -0.013582194, -0.0027590916, -0.017594207, -0.026804507, -0.0014236979, -0.022032745, 0.0091236625, -0.0042419364, -0.00858384, -0.0033905501, -0.020739838, 0.016821127, 0.022539245, 0.015381602, 0.015141681, 0.028817179, -0.019726837, -0.0051283115, -0.011489551, -0.013208984, -0.0047017853, -0.0072309524, 0.01767418, 0.0025658219, -0.010323267, 0.012609182, -0.028097415, 0.026871152, -0.010276617, 0.021912785, 0.0022542577, 0.005124979, -0.0019710176, 0.004518512, -0.040360045, 0.010969722, -0.0031539614, -0.020366628, -0.025778178, -0.0110030435, -0.016221326, 0.0036587953, 0.016207997, 0.003007343, -0.0032555948, 0.0044052163, -0.022046074, -0.0008822095, -0.009363583, 0.028230704, -0.024538586, 0.0029840174, 0.0016044717, -0.014181997, 0.031349678, -0.014381931, -0.027750863, 0.02613806, 0.0004136138, -0.005748107, -0.01868718, -0.0010138329, 0.0054348772, 0.010703143, -0.003682121, 0.0030856507, -0.004275259, -0.010403241, 0.021113047, -0.022685863, -0.023032416, 0.031429652, 0.001792743, -0.005644808, -0.011842767, -0.04078657, -0.0026874484, 0.06915057, -0.00056939584, -0.013995391, 0.010703143, -0.013728813, -0.022939114, -0.015261642, -0.022485929, 0.016807798, 0.007964044, 0.0144219175, 0.016821127, 0.0076241563, 0.005461535, -0.013248971, 0.015301628, 0.0085171955, -0.004318578, 0.011136333, -0.0059047225, -0.010249958, -0.018207338, 0.024645219, 0.021752838, 0.0007614159, -0.013648839, 0.01111634, -0.010503208, -0.0038487327, -0.008203966, -0.00397869, 0.0029740208, 0.008530525, 0.005261601, 0.01642126, -0.0038753906, -0.013222313, 0.026537929, 0.024671877, -0.043505676, 0.014195326, 0.024778508, 0.0056914594, -0.025951454, 0.017620865, -0.0021359634, 0.008643821, 0.021299653, 0.0041686273, -0.009017031, 0.04044002, 0.024378639, -0.027777521, -0.014208655, 0.0028623908, 0.042119466, 0.005801423, -0.028124074, -0.03129636, 0.022139376, -0.022179363, -0.04067994, 0.013688826, 0.013328944, 0.0046184794, -0.02828402, -0.0063412455, -0.0046184794, -0.011756129, -0.010383247, -0.0018543894, -0.0018593877, -0.00052024535, 0.004815081, 0.014781799, 0.018007403, 0.01306903, -0.020433271, 0.009043689, 0.033189073, -0.006844413, -0.019766824, -0.018767154, 0.00533491, -0.0024575242, 0.018727167, 0.0058080875, -0.013835444, 0.0040719924, 0.004881726, 0.012029372, 0.005664801, 0.03193615, 0.0058047553, 0.002695779, 0.009290274, 0.02361889, 0.017834127, 0.0049017193, -0.0036388019, 0.010776452, -0.019793482, 0.0067777685, -0.014208655, -0.024911797, 0.002385881, 0.0034988478, 0.020899786, -0.0025858153, -0.011849431, 0.033189073, -0.021312982, 0.024965113, -0.014635181, 0.014048708, -0.0035921505, -0.003347231, 0.030869836, -0.0017161017, -0.0061346465, 0.009203636, -0.025165047, 0.0068510775, 0.021499587, 0.013782129, -0.0024475274, -0.0051149824, -0.024445284, 0.006167969, 0.0068844, -0.00076183246, 0.030150073, -0.0055948244, -0.011162991, -0.02057989, -0.009703471, -0.020646535, 0.008004031, 0.0066378145, -0.019900113, -0.012169327, -0.01439526, 0.0044252095, -0.004018677, 0.014621852, -0.025085073, -0.013715484, -0.017980747, 0.0071043274, 0.011456228, -0.01010334, -0.0035321703, -0.03801415, -0.012036037, -0.0028990454, -0.05419549, -0.024058744, -0.024272008, 0.015221654, 0.027964126, 0.03182952, -0.015354944, 0.004855068, 0.011522872, 0.004771762, 0.0027874154, 0.023405626, 0.0004242353, -0.03132302, 0.007057676, 0.008763781, -0.0027057757, 0.023005757, -0.0071176565, -0.005238275, 0.029110415, -0.010989714, 0.013728813, -0.009630162, -0.029137073, -0.0049317093, -0.0008630492, -0.015248313, 0.0043219104, -0.0055681667, -0.013175662, 0.029723546, 0.025098402, 0.012849103, -0.0009996708, 0.03118973, -0.0021709518, 0.0260181, -0.020526575, 0.028097415, -0.016141351, 0.010509873, -0.022965772, 0.002865723, 0.0020493253, 0.0020509914, -0.0041419696, -0.00039695262, 0.017287642, 0.0038987163, 0.014795128, -0.014661839, -0.008950386, 0.004431874, -0.009383577, 0.0012604183, -0.023019087, 0.0029273694, -0.033135757, 0.009176978, -0.011023037, -0.002102641, 0.02663123, -0.03849399, -0.0044152127, 0.0004527676, -0.0026924468, 0.02828402, 0.017727496, 0.035135098, 0.02728435, -0.005348239, -0.001467017, -0.019766824, 0.014715155, 0.011982721, 0.0045651635, 0.023458943, -0.0010046692, -0.0031373003, -0.0006972704, 0.0019043729, -0.018967088, -0.024311995, 0.0011546199, 0.007977373, -0.004755101, -0.010016702, -0.02780418, -0.004688456, 0.013022379, -0.005484861, 0.0017227661, -0.015394931, -0.028763862, -0.026684547, 0.0030589928, -0.018513903, 0.028363993, 0.0044818576, -0.009270281, 0.038920518, -0.016008062, 0.0093902415, 0.004815081, -0.021059733, 0.01451522, -0.0051583014, 0.023765508, -0.017874114, -0.016821127, -0.012522544, -0.0028390652, 0.0040886537, 0.020259995, -0.031216389, -0.014115352, -0.009176978, 0.010303274, 0.020313311, 0.0064112223, -0.02235264, -0.022872468, 0.0052449396, 0.0005723116, 0.0037321046, 0.016807798, -0.018527232, -0.009303603, 0.0024858483, -0.0012662497, -0.007110992, 0.011976057, -0.007790768, -0.042999174, -0.006727785, -0.011829439, 0.007024354, 0.005278262, -0.017740825, -0.0041519664, 0.0085905045, 0.027750863, -0.038387362, 0.024391968, 0.00087721116, 0.010509873, -0.00038508154, -0.006857742, 0.0183273, -0.0037054466, 0.015461575, 0.0017394272, -0.0017944091, 0.014181997, -0.0052682655, 0.009023695, 0.00719763, -0.013522214, 0.0034422, 0.014941746, -0.0016711164, -0.025298337, -0.017634194, 0.0058714002, -0.005321581, 0.017834127, 0.0110630235, -0.03369557, 0.029190388, -0.008943722, 0.009363583, -0.0034222065, -0.026111402, -0.007037683, -0.006561173, 0.02473852, -0.007084334, -0.010110005, -0.008577175, 0.0030439978, -0.022712521, 0.0054582027, -0.0012620845, -0.0011954397, -0.015741484, 0.0129557345, -0.00042111133, 0.00846388, 0.008930393, 0.016487904, 0.010469886, -0.007917393, -0.011762793, -0.0214596, 0.000917198, 0.021672864, 0.010269952, -0.007737452, -0.010243294, -0.0067244526, -0.015488233, -0.021552904, 0.017127695, 0.011109675, 0.038067464, 0.00871713, -0.0025591573, 0.021312982, -0.006237946, 0.034628596, -0.0045251767, 0.008357248, 0.020686522, 0.0010696478, 0.0076708077, 0.03772091, -0.018700508, -0.0020676525, -0.008923728, -0.023298996, 0.018233996, -0.010256623, 0.0017860786, 0.009796774, -0.00897038, -0.01269582, -0.018527232, 0.009190307, -0.02372552, -0.042119466, 0.008097334, -0.0066778013, -0.021046404, 0.0019593548, 0.011083017, -0.0016028056, 0.012662497, -0.000059095124, 0.0071043274, -0.014675168, 0.024831824, -0.053582355, 0.038387362, 0.0005698124, 0.015954746, 0.021552904, 0.031589597, -0.009230294, -0.0006147976, 0.002625802, -0.011749465, -0.034362018, -0.0067844326, -0.018793812, 0.011442899, -0.008743787, 0.017474247, -0.021619547, 0.01831397, -0.009037024, -0.0057247817, -0.02728435, 0.010363255, 0.034415334, -0.024032086, -0.0020126705, -0.0045518344, -0.019353628, -0.018340627, -0.03129636, -0.0034038792, -0.006321252, -0.0016161345, 0.033642255, -0.000056075285, -0.005005019, 0.004571828, -0.0024075406, -0.00010215386, 0.0098634185, 0.1980148, -0.003825407, -0.025191706, 0.035161756, 0.005358236, 0.025111731, 0.023485601, 0.0023342315, -0.011882754, 0.018287312, -0.0068910643, 0.003912045, 0.009243623, -0.001355387, -0.028603915, -0.012802451, -0.030150073, -0.014795128, -0.028630573, -0.0013487226, 0.002667455, 0.00985009, -0.0033972147, -0.021486258, 0.009503538, -0.017847456, 0.013062365, -0.014341944, 0.005078328, 0.025165047, -0.015594865, -0.025924796, -0.0018177348, 0.010996379, -0.02993681, 0.007324255, 0.014475234, -0.028577257, 0.005494857, 0.00011725306, -0.013315615, 0.015941417, 0.009376912, 0.0025158382, 0.008743787, 0.023832154, -0.008084005, -0.014195326, -0.008823762, 0.0033455652, -0.032362677, -0.021552904, -0.0056081535, 0.023298996, -0.025444955, 0.0097301295, 0.009736794, 0.015274971, -0.0012937407, -0.018087378, -0.0039387033, 0.008637156, -0.011189649, -0.00023846315, -0.011582852, 0.0066411467, -0.018220667, 0.0060846633, 0.0376676, -0.002709108, 0.0072776037, 0.0034188742, -0.010249958, -0.0007747449, -0.00795738, -0.022192692, 0.03910712, 0.032122757, 0.023898797, 0.0076241563, -0.007397564, -0.003655463, 0.011442899, -0.014115352, -0.00505167, -0.031163072, 0.030336678, -0.006857742, -0.022259338, 0.004048667, 0.02072651, 0.0030156737, -0.0042119464, 0.00041861215, -0.005731446, 0.011103011, 0.013822115, 0.021512916, 0.009216965, -0.006537847, -0.027057758, -0.04054665, 0.010403241, -0.0056281467, -0.005701456, -0.002709108, -0.00745088, -0.0024841821, 0.009356919, -0.022659205, 0.004061996, -0.013175662, 0.017074378, -0.006141311, -0.014541878, 0.02993681, -0.00028448965, -0.025271678, 0.011689484, -0.014528549, 0.004398552, -0.017274313, 0.0045751603, 0.012455898, 0.004121976, -0.025458284, -0.006744446, 0.011822774, -0.015035049, -0.03257594, 0.014675168, -0.0039187097, 0.019726837, -0.0047251107, 0.0022825818, 0.011829439, 0.005391558, -0.016781142, -0.0058747325, 0.010309938, -0.013049036, 0.01186276, -0.0011246296, 0.0062112883, 0.0028190718, -0.021739509, 0.009883412, -0.0073175905, -0.012715813, -0.017181009, -0.016607866, -0.042492677, -0.0014478565, -0.01794076, 0.012302616, -0.015194997, -0.04433207, -0.020606548, 0.009696807, 0.010303274, -0.01694109, -0.004018677, 0.019353628, -0.001991011, 0.000058938927, 0.010536531, -0.17274313, 0.010143327, 0.014235313, -0.024152048, 0.025684876, -0.0012504216, 0.036601283, -0.003698782, 0.0007310093, 0.004165295, -0.0029157067, 0.017101036, -0.046891227, -0.017460918, 0.022965772, 0.020233337, -0.024072073, 0.017220996, 0.009370248, 0.0010363255, 0.0194336, -0.019606877, 0.01818068, -0.020819811, 0.007410893, 0.0019326969, 0.017887443, 0.006651143, 0.00067394477, -0.011889419, -0.025058415, -0.008543854, 0.021579562, 0.0047484366, 0.014062037, 0.0075508473, -0.009510202, -0.009143656, 0.0046817916, 0.013982063, -0.0027990784, 0.011782787, 0.014541878, -0.015701497, -0.029350337, 0.021979429, 0.01332228, -0.026244693, -0.0123492675, -0.003895384, 0.0071576433, -0.035454992, -0.00046984528, 0.0033522295, 0.039347045, 0.0005119148, 0.00476843, -0.012995721, 0.0024042083, -0.006931051, -0.014461905, -0.0127558, 0.0034555288, -0.0074842023, -0.030256703, -0.007057676, -0.00807734, 0.007804097, -0.006957709, 0.017181009, -0.034575284, -0.008603834, -0.005008351, -0.015834786, 0.02943031, 0.016861115, -0.0050849924, 0.014235313, 0.0051449724, 0.0025924798, -0.0025741523, 0.04289254, -0.002104307, 0.012969063, -0.008310596, 0.00423194, 0.0074975314, 0.0018810473, -0.014248641, -0.024725191, 0.0151016945, -0.017527562, 0.0018727167, 0.0002830318, 0.015168339, 0.0144219175, -0.004048667, -0.004358565, 0.011836103, -0.010343261, -0.005911387, 0.0022825818, 0.0073175905, 0.00403867, 0.013188991, 0.03334902, 0.006111321, 0.008597169, 0.030123414, -0.015474904, 0.0017877447, -0.024551915, 0.013155668, 0.023525586, -0.0255116, 0.017220996, 0.004358565, -0.00934359, 0.0099967085, 0.011162991, 0.03092315, -0.021046404, -0.015514892, 0.0011946067, -0.01816735, 0.010876419, -0.10124666, -0.03550831, 0.0056348112, 0.013942076, 0.005951374, 0.020419942, -0.006857742, -0.020873128, -0.021259667, 0.0137554705, 0.0057880944, -0.029163731, -0.018767154, -0.021392956, 0.030896494, -0.005494857, -0.0027307675, -0.006801094, -0.014821786, 0.021392956, -0.0018110704, -0.0018843795, -0.012362596, -0.0072176233, -0.017194338, -0.018713837, -0.024272008, 0.03801415, 0.00015880188, 0.0044951867, -0.028630573, -0.0014070367, -0.00916365, -0.026537929, -0.009576847, -0.013995391, -0.0077107945, 0.0050016865, 0.00578143, -0.04467862, 0.008363913, 0.010136662, -0.0006268769, -0.006591163, 0.015341615, -0.027377652, -0.00093136, 0.029243704, -0.020886457, -0.01041657, -0.02424535, 0.005291591, -0.02980352, -0.009190307, 0.019460259, -0.0041286405, 0.004801752, 0.0011787785, -0.001257086, -0.011216307, -0.013395589, 0.00088137644, -0.0051616337, 0.03876057, -0.0033455652, 0.00075850025, -0.006951045, -0.0062112883, 0.018140694, -0.006351242, -0.008263946, 0.018154023, -0.012189319, 0.0075508473, -0.044358727, -0.0040153447, 0.0093302615, -0.010636497, 0.032789204, -0.005264933, -0.014235313, -0.018393943, 0.007297597, -0.016114693, 0.015021721, 0.020033404, 0.0137688, 0.0011046362, 0.010616505, -0.0039453674, 0.012109346, 0.021099718, -0.0072842683, -0.019153694, -0.003768759, 0.039320387, -0.006747778, -0.0016852784, 0.018154023, 0.0010963057, -0.015035049, -0.021033075, -0.04345236, 0.017287642, 0.016341286, -0.008610498, 0.00236922, 0.009290274, 0.028950468, -0.014475234, -0.0035654926, 0.015434918, -0.03372223, 0.004501851, -0.012929076, -0.008483873, -0.0044685286, -0.0102233, 0.01615468, 0.0022792495, 0.010876419, -0.0059647025, 0.01895376, -0.0069976957, -0.0042952523, 0.017207667, -0.00036133936, 0.0085905045, 0.008084005, 0.03129636, -0.016994404, -0.014915089, 0.020100048, -0.012009379, -0.006684466, 0.01306903, 0.00015765642, -0.00530492, 0.0005277429, 0.015421589, 0.015528221, 0.032202728, -0.003485519, -0.0014286962, 0.033908837, 0.001367883, 0.010509873, 0.025271678, -0.020993087, 0.019846799, 0.006897729, -0.010216636, -0.00725761, 0.01818068, -0.028443968, -0.011242964, -0.014435247, -0.013688826, 0.006101324, -0.0022509254, 0.013848773, -0.0019077052, 0.017181009, 0.03422873, 0.005324913, -0.0035188415, 0.014128681, -0.004898387, 0.005038341, 0.0012320944, -0.005561502, -0.017847456, 0.0008538855, -0.0047884234, 0.011849431, 0.015421589, -0.013942076, 0.0029790192, -0.013702155, 0.0001199605, -0.024431955, 0.019926772, 0.022179363, -0.016487904, -0.03964028, 0.0050849924, 0.017487574, 0.022792496, 0.0012504216, 0.004048667, -0.00997005, 0.0076041627, -0.014328616, -0.020259995, 0.0005598157, -0.010469886, 0.0016852784, 0.01716768, -0.008990373, -0.001987679, 0.026417969, 0.023792166, 0.0046917885, -0.0071909656, -0.00032051947, -0.023259008, -0.009170313, 0.02071318, -0.03156294, -0.030869836, -0.006324584, 0.013795458, -0.00047151142, 0.016874444, 0.00947688, 0.00985009, -0.029883493, 0.024205362, -0.013522214, -0.015075036, -0.030603256, 0.029270362, 0.010503208, 0.021539574, 0.01743426, -0.023898797, 0.022019416, -0.0068777353, 0.027857494, -0.021259667, 0.0025758184, 0.006197959, 0.006447877, -0.00025200035, -0.004941706, -0.021246338, -0.005504854, -0.008390571, -0.0097301295, 0.027244363, -0.04446536, 0.05216949, 0.010243294, -0.016008062, 0.0122493, -0.0199401, 0.009077012, 0.019753495, 0.006431216, -0.037960835, -0.027377652, 0.016381273, -0.0038620618, 0.022512587, -0.010996379, -0.0015211658, -0.0102233, 0.007071005, 0.008230623, -0.009490209, -0.010083347, 0.024431955, 0.002427534, 0.02828402, 0.0035721571, -0.022192692, -0.011882754, 0.010056688, 0.0011904413, -0.01426197, -0.017500903, -0.00010985966, 0.005591492, -0.0077707744, -0.012049366, 0.011869425, 0.00858384, -0.024698535, -0.030283362, 0.020140035, 0.011949399, -0.013968734, 0.042732596, -0.011649498, -0.011982721, -0.016967745, -0.0060913274, -0.007130985, -0.013109017, -0.009710136
                    // ],
        //             'numCandidates': 150,
        //             'limit': 10
        //         }
        //     }, {
        //         '$project': {
        //             '_id': 0,
        //             'plot': 1,
        //             'title': 1,
        //             'score': {
        //                 '$meta': 'vectorSearchScore'
        //             }
        //         }
        //     }
        // ];

        //vector search example with ENN (exact nearest neighbors)
        const agg = [
            {
                '$vectorSearch': {
                    'index': 'movies',
                    'path': 'plot_embedding',
                    'queryVector': [
                        -0.006954097, -0.009932499, -0.001311474, -0.021280076, -0.014608995, -0.008227668, -0.013274779, -0.0069271433, -0.009521453, -0.030943038, 0.017304381, 0.015094165, -0.010397454, 0.010943269, 0.012230316, 0.025943095, 0.02583528, 0.001368751, 0.009777515, -0.016024074, -0.013989056, 0.00685639, 0.030242238, -0.023881124, -0.011057823, -0.0056906347, -0.00055929273, -0.03199424, 0.0072168973, -0.023166848, 0.0033490178, -0.024069803, -0.023557678, -0.020862292, 0.007452744, -0.019002475, 0.007850314, -0.032856762, -0.012951332, 0.003005356, -0.003739849, 0.010053792, 0.019541552, 0.007702067, -0.035498243, -0.00918453, -0.0143529335, 0.000249955, -0.011866439, 0.019703276, 0.0076481593, 0.025161434, -0.015714103, -0.0076818517, -0.023180325, -0.0032883717, -0.02315337, 0.015188503, 0.031347346, -0.008739791, 0.01454161, 0.014824626, -0.025107525, 0.0012558816, -0.012803086, -0.013146748, -0.01652272, 0.01283004, -0.019352876, -0.010444623, 0.04706145, 0.030754361, 0.008820653, 0.011657547, 0.014878534, -0.010181823, 0.00041673204, -0.009103668, -0.0055255424, 0.00579845, 0.024110233, -0.020404076, -0.0066272817, -0.005299804, 0.019649368, 0.007729021, -0.0066845585, 0.025592696, 0.00575465, -0.014824626, 0.00033334352, -0.008591545, 0.004164372, 0.028085928, -0.020875769, -0.00448108, -0.009258653, 0.02535011, -0.0025538788, -0.059082873, -0.0074055744, 0.005950066, -0.014164257, -0.016185796, -0.015768012, -0.01309284, 0.0030222023, 0.0028436328, 0.0037095258, -0.0068462817, -0.010963485, 0.018988999, 0.010929792, -0.03967609, 0.016994413, -0.023503771, -0.0037903874, -0.012075332, -0.005923112, -0.01902943, 0.017978229, -0.005993866, 0.024015894, -0.017722167, 0.010875884, 0.0153637035, -0.04045775, -0.0016568204, -0.0074190516, 0.0011084777, 0.033018485, 0.021536138, 0.025794849, -0.019622413, -0.041724585, 0.014743765, -0.011111731, 0.0065666353, -0.019851523, -0.035174794, 0.007270805, 0.02698082, -0.010929792, -0.020148015, -0.009689915, 0.032182917, 0.015700627, 0.013786903, -0.0021647324, -0.0063644815, 0.027317744, 0.004403588, 0.03158993, -0.0039116796, 0.02029626, 0.04191326, -0.0050504804, 0.008416344, -0.0034602026, 0.010485054, -0.0030996946, -0.0212666, 0.0043934803, -0.016765304, -0.00039441086, 0.025538787, 0.008483729, 0.017479582, -0.0061454815, -0.018220814, -0.0025589326, 0.0102829, -0.045498125, 0.029784022, 0.017169613, 0.020592753, 0.012445947, 0.021630477, -0.031050853, -0.011327362, -0.024689741, 0.0048988652, 0.022129124, 0.0114621315, -0.026091343, 0.015067211, 0.004723665, 0.017722167, 0.014608995, -0.016805734, 0.0042250184, 0.027843343, 0.03264113, 0.007034959, -0.6852751, -0.019986292, 0.003827449, 0.0032462562, 0.006115158, -0.001972686, 0.001937309, 0.015956689, -0.010437884, 0.00803899, -0.01401601, -0.00026869634, -0.033207163, -0.00623982, -0.0048449575, -0.013193917, -0.00426208, -0.013207395, -0.014379887, 0.017991705, 0.0007264909, 0.023517247, -0.00725059, 0.0071832053, -0.003466941, -0.0072842822, 0.0028234175, -0.02460888, 0.0044608647, -0.008746529, -0.025713988, 0.012499855, 0.004882019, 0.010525485, 0.05250613, -0.003387764, -0.021212691, 0.026549557, 0.034123596, 0.014325979, -0.0080592055, -0.012189886, -0.005970281, 0.0115093, 0.0021731553, 0.033557564, 0.020929677, -0.02130703, 0.022991648, -0.03123953, 0.0102829, -0.0067721587, 0.008510683, 0.010013361, 0.031320393, 0.010646777, 0.015215457, -0.019797614, 0.0022186402, -0.0010351969, 0.0015523742, 0.021630477, 0.00751339, 0.0062162355, -0.016468812, 0.018840753, -0.02544445, 0.030943038, 0.008295052, -0.005700743, -0.0033557562, 0.020053675, -0.012722225, -0.016778782, 0.025511835, 0.025538787, 0.022802971, -0.017708689, -0.009615792, -0.00733819, 0.0049224496, -0.021590047, -0.021158785, 0.022034785, 0.046872772, -0.021064445, -0.024811033, 0.0043429416, -0.006169066, -0.0044406494, -0.003357441, 0.006445343, -0.01801866, -0.0082074525, 0.0037802798, 0.02258734, 0.0018598167, -0.0101548685, 0.020134538, -0.008214191, -0.0004830638, 0.00421828, 0.0048719114, 0.0087869605, -0.008335483, 0.023503771, -0.030161375, 0.0055929273, 0.054069456, -0.010006622, 0.018975522, 0.015956689, -0.018530782, 0.003669095, 0.014662903, -0.023126416, 0.011300408, 0.021563092, -0.00106552, -0.03269504, 0.020282784, -0.023665493, 0.025242295, -0.01801866, -0.008537637, -0.00083472754, 0.02130703, -0.008780221, 0.0080592055, -0.0012971548, 0.014838103, 0.0056704194, 0.015794965, 0.001546478, 0.013072625, 0.0057310658, 0.011711455, -0.020997062, 0.010289638, 0.0041070953, -0.025592696, 0.012661578, -0.013436502, 0.013348902, 0.014312503, -0.023894602, -0.018517306, -0.0105928695, -0.02140137, 0.0076885903, 0.03220987, -0.0042283875, -0.04649542, -0.000022110593, 0.00013803327, -0.0046293265, -0.0036286642, -0.028598052, -0.0042856648, -0.029406667, 0.026765188, 0.0027711943, -0.0059298505, -0.00311991, 0.016293611, -0.027182974, -0.011623855, 0.0030508407, -0.0035747564, -0.018032135, 0.03045787, 0.0011337469, -0.004780942, 0.012055117, -0.0081333285, 0.02908322, -0.008092898, -0.0015944897, 0.014716811, 0.014325979, -0.0037061565, -0.0074325283, -0.01854426, -0.0070821284, -0.003598341, -0.01718309, -0.0108826235, 0.014959396, -0.019366352, 0.017722167, 0.009528192, 0.022439092, -0.01630709, -0.003625295, -0.00413068, -0.007311236, -0.008503945, -0.006024189, 0.038867474, 0.030943038, 0.015956689, 0.007196682, 0.013699302, 0.0025471402, 0.026792143, -0.031832516, -0.018867707, -0.03897529, 0.04679191, 0.00421828, 0.01634752, -0.004120572, -0.009696653, -0.011414962, 0.011980994, 0.045659848, -0.010080745, -0.0045720492, -0.020794908, -0.0030205175, -0.00896216, -0.0071427743, 0.006559897, 0.0045147724, -0.032991532, 0.0059332196, 0.0033153256, 0.00426208, 0.0063779587, -0.025943095, -0.021495707, -0.008268098, -0.002429217, 0.0102829, -0.0048786495, 0.003584864, 0.004737142, -0.029244944, 0.027169496, 0.010599608, -0.008517422, -0.0016652435, 0.023544202, -0.022398662, 0.010202038, 0.0029211252, 0.021185739, -0.01708875, -0.03396187, 0.025121003, -0.009838161, 0.015633242, -0.015525427, 0.003743218, 0.0044676033, -0.021819154, -0.006802482, -0.023126416, 0.028112883, 0.03045787, 0.015255888, -0.008685883, -0.010943269, -0.0039386335, -0.0014950972, -0.009043022, -0.0023264554, -0.0028975406, -0.0021377786, 0.002860479, -0.0010166661, -0.01173167, 0.03040396, -0.028005067, -0.00509765, -0.008463514, 0.019959338, -0.012533547, -0.012782871, -0.0055558654, 0.004807896, -0.018800322, 0.005582819, 0.017991705, -0.005505327, -0.008382652, 0.0011404854, -0.0035073718, -0.017587397, 0.012890686, -0.0015363704, -0.000308706, 0.011603639, -0.0042452337, -0.027129065, -0.0086387135, 0.023786787, -0.024352817, -0.015175027, 0.017546967, 0.0064318664, 0.0100874845, -0.008605022, -0.006529574, 0.014703333, -0.0010318276, -0.012290963, -0.014622472, -0.008382652, -0.000661212, 0.0044170646, 0.009386684, -0.0030660022, 0.0033102715, -0.007095605, 0.007978344, -0.016980935, -0.0040262337, 0.022344755, 0.0077357595, 0.0063341586, -0.016482288, -0.028220698, -0.026899958, 0.08291009, 0.014002534, 0.00075428706, 0.013018717, 0.0013485356, -0.0223178, -0.016697919, -0.018584691, 0.0057378043, 0.007924437, 0.0032850024, -0.01735829, 0.029730113, 0.021684386, -0.008382652, 0.017021365, 0.0030811639, -0.008025514, 0.0043564187, -0.000044694985, -0.0038375566, -0.012924379, -0.012230316, 0.0345279, -0.014689857, -0.019406782, 0.008780221, 0.0092923455, -0.01555238, -0.01920463, -0.01827472, -0.00305421, -0.017573921, 0.016320566, 0.02548488, 0.02105097, 0.012823301, 0.03431227, 0.026589988, -0.025606172, 0.007755975, 0.0019693167, 0.0096494835, -0.034069687, 0.0067721587, 0.0004190484, 0.005508696, 0.033207163, -0.0011792317, -0.012648102, 0.022829924, 0.015821919, -0.035956457, -0.038732704, -0.020740999, 0.0063880663, -0.010471577, -0.006933882, 0.005936589, 0.015889304, -0.00852416, -0.031455163, 0.009305822, 0.0051178653, -0.027452512, -0.015700627, -0.017762598, -0.005869204, -0.0065531586, -0.011879916, -0.008220929, -0.0053503425, -0.0026920172, -0.00038830412, 0.019959338, -0.010444623, -0.00047548304, -0.015040257, 0.0008330429, 0.008005298, -0.0075336057, -0.02117226, -0.027250359, -0.018962044, -0.006138743, 0.014918964, -0.014757241, -0.013867764, 0.0006961678, 0.01726395, -0.0039352644, 0.005724327, 0.019878477, 0.009494499, 0.0071832053, -0.0023652017, 0.004865173, 0.029784022, 0.002390471, 0.0005854043, 0.00034387235, 0.0053975116, -0.011650808, 0.005218942, 0.007136036, -0.0091440985, 0.005879312, 0.028193744, -0.024662787, -0.0029447097, 0.009636007, -0.029730113, 0.00025206077, 0.006745205, 0.011522777, 0.02035017, 0.026131773, 0.029972699, 0.008012037, -0.012466162, 0.012459424, -0.01836906, 0.0051515577, 0.022196509, -0.015970165, 0.0037465873, -0.008396129, -0.009494499, -0.0036657257, 0.011219546, -0.01823429, 0.013524102, 0.015134595, 0.020269306, -0.0028891175, 0.008456775, 0.0051650344, 0.011131947, -0.0038948336, -0.010909577, -0.010485054, -0.026859527, -0.005475004, -0.0036589873, 0.0034602026, -0.026253065, -0.010350284, 0.0137734255, 0.0030828484, 0.012526809, -0.026131773, -0.02363854, 0.00024321652, -0.015956689, -0.0042991415, -0.027762482, -0.012782871, -0.016940504, 0.01256724, 0.03598341, 0.026387835, 0.0013763318, 0.0041946955, 0.0017520012, -0.007755975, -0.011179116, 0.003537695, 0.011522777, -0.035929505, 0.021037493, 0.041859355, 0.034770485, -0.012769394, 0.0059534353, 0.02851719, 0.017749121, -0.011017392, 0.0059568044, -0.02105097, -0.011233023, 0.0095079765, -0.0019002475, -0.006472297, -0.00826136, -0.011495824, -0.024056325, 0.00628362, 0.0028689022, 0.0050808038, 0.00632742, 0.020228876, -0.0029767177, 0.0327759, -0.016859643, 0.0006439447, -0.01516155, 0.015889304, 0.0032765793, -0.0017570552, 0.016509242, 0.0076481593, 0.0033254332, -0.012513332, -0.0073718824, -0.012237055, 0.025997004, -0.0052122036, -0.0007530236, -0.01739872, -0.020188445, -0.0005908793, -0.011212808, 0.008840868, -0.015741058, 0.0034197718, -0.0033456485, -0.010262684, 0.010080745, -0.016751828, -0.04415043, 0.010202038, 0.0058557275, 0.023369001, 0.009238438, 0.04029603, 0.009743823, -0.006802482, -0.01502678, 0.01634752, -0.018301675, 0.011313885, 0.030080514, 0.009501237, 0.000942543, -0.007755975, -0.015242411, 0.003898203, -0.017236996, -0.026172204, 0.02394851, 0.0065834816, 0.021617, 0.0054514194, -0.039487414, -0.021549616, 0.018813798, -0.025848757, 0.0026566405, -0.011199331, -0.024635833, -0.01129367, 0.010181823, -0.033638425, 0.033072393, -0.008537637, -0.02597005, 0.010444623, -0.037169382, -0.0003693522, 0.008793699, -0.006647497, 0.014716811, -0.026023958, -0.011455393, 0.0012853625, -0.0063072047, -0.01103087, -0.0034736795, -0.010390716, 0.021913493, -0.021509185, 0.0022085323, -0.003756695, 0.009656223, 0.016549673, 0.0022186402, -0.020687092, -0.029056268, -0.00065447355, -0.0035309563, 0.009305822, 0.007958129, -0.0086387135, -0.02035017, -0.029298851, -0.007479698, -0.0205658, -0.0051178653, -0.003770172, -0.02394851, -0.020174969, 0.010053792, -0.014325979, 0.014811149, -0.0015481627, -0.0060073426, -0.0028116251, 0.04091597, -0.026873004, 0.00038851472, 0.0037769105, 0.017344812, -0.003067687, 0.023099463, 0.0015094165, -0.030296145, 0.045012955, -0.035147842, -0.0067553124, 0.0090025915, 0.0063408967, 0.020538846, -0.0011295355, 0.0006153062, 0.03870575, 0.03840926, 0.007486436, -0.040619474, -0.0059466967, 0.033934917, 0.018813798, 0.026037434, 0.0026195787, -0.010424407, 0.011960777, -0.0032277254, 0.007924437, 0.011617116, -0.028328514, -0.024622357, 0.0014639319, 0.025147956, -0.00003919366, -0.008800437, -0.0345279, 0.009757299, -0.003044102, 0.023786787, 0.008989114, -0.018207336, -0.0035612795, 0.0025185018, -0.00079050637, -0.00048643304, 0.0041778493, -0.00927213, -0.014285549, -0.018705983, -0.024150664, -0.021509185, -0.0032193023, 0.028220698, -0.005720958, 0.00070711784, -0.016953982, -0.0071629896, -0.02702125, 0.0040093875, 0.00628362, -0.0021411476, 0.029110175, 0.018220814, 0.0071562515, 0.022924263, 0.0076144673, -0.002565671, 0.0020771322, 0.004016126, -0.007836836, 0.0016509243, 0.005485112, 0.0061050504, -0.018988999, 0.0060713585, -0.0017823244, 0.0054413117, -0.0059837583, -0.0060342965, 0.013348902, -0.0223178, -0.01300524, -0.013261302, -0.0058995276, 0.030377006, -0.002319717, -0.02948753, 0.0110982545, 0.000072175295, -0.006657605, -0.031131715, 0.00733819, -0.0033186947, -0.02649565, 0.0060983123, 0.011441916, -0.014555087, 0.007291021, -0.017735643, 0.03654944, 0.024622357, 0.0003013358, 0.02227737, 0.0105457, 0.025026664, -0.0013965472, -0.012836779, -0.017803028, 0.0021849477, 0.025997004, 0.00009791834, 0.007048436, -0.00032555216, 0.026131773, -0.025053618, 0.01361844, -0.023517247, -0.0023230864, -0.014892011, 0.016239705, 0.022021309, -0.016967459, 0.019056384, 0.0047539882, 0.0029598714, -0.0013519048, -0.0045585725, 0.0015439511, 0.021509185, -0.0050909114, 0.029999653, 0.00074712746, -0.011354316, -0.0037735412, 0.0031805562, -0.0055962964, 0.019298967, 0.18652076, -0.010640038, 0.0029514483, 0.018962044, -0.0013190547, 0.011852963, 0.020444507, -0.004720296, 0.0021344093, -0.0016542935, -0.008005298, 0.013854287, 0.0020181707, 0.007210159, -0.0037162642, -0.0023129785, -0.03415055, -0.03202119, -0.023665493, 0.012621148, 0.00927213, -0.006630651, -0.007958129, -0.009379946, 0.026172204, -0.006947359, -0.008679145, -0.0073516667, 0.01739872, 0.0014209741, -0.000361982, 0.012142717, -0.0030036713, 0.0080592055, -0.021873062, -0.0064116507, 0.008227668, -0.028598052, 0.0013156856, 0.018476875, -0.014231641, 0.010929792, 0.0066373893, 0.03840926, 0.015565857, 0.009777515, -0.0049628806, 0.006920405, 0.019528076, 0.030646546, -0.028948452, -0.008335483, 0.012412256, 0.040942922, 0.016482288, 0.022021309, 0.0041946955, 0.0058759428, -0.011219546, -0.022021309, -0.016401427, 0.020660138, -0.02632045, 0.023355525, -0.018759891, 0.014299026, -0.029406667, 0.0076346826, 0.019891953, -0.021387892, -0.0071629896, -0.014110349, -0.026684327, -0.004797788, -0.015606288, -0.006570005, 0.034986116, 0.006738466, -0.009838161, 0.0011303778, -0.010538962, -0.03444704, 0.00685639, -0.003888095, -0.009494499, -0.013800379, 0.017236996, 0.017614352, -0.017546967, 0.017614352, 0.0024612248, -0.0006982736, -0.008800437, 0.0016677704, -0.004666388, -0.0050605885, 0.018975522, 0.009602315, -0.0034416718, -0.01401601, -0.018247766, -0.00032576272, 0.005114496, 0.009016068, -0.009609053, -0.0049662497, -0.001726732, 0.0019339399, -0.010774808, -0.004016126, -0.0065127276, -0.018759891, 0.0020063785, -0.0052661113, -0.0073449286, 0.0017671628, -0.034905255, -0.014218165, 0.004235126, -0.019649368, 0.00010865777, -0.025727466, 0.030781314, -0.00861176, -0.016158843, -0.016617058, -0.01454161, -0.0020333321, 0.002092294, -0.032533314, 0.006206128, -0.029433621, 0.004663019, -0.023625063, -0.021199215, 0.0073988363, 0.007715544, 0.00680922, -0.01103087, 0.012270748, 0.012614409, -0.034420088, -0.003898203, 0.015848873, -0.0030828484, -0.0054244655, 0.030107468, 0.002491548, -0.009993146, -0.014824626, -0.026266541, -0.000074912794, -0.0048719114, -0.012277486, 0.014770718, -0.021428322, -0.03506698, -0.013086102, -0.0028571098, 0.024554972, -0.03439313, -0.010902839, 0.04474342, -0.017196566, 0.0026819096, 0.00081240636, -0.17476887, 0.004710188, 0.024231525, -0.00033229063, 0.025902664, 0.027762482, 0.008268098, 0.00016561887, 0.00027080212, 0.0032934255, 0.011799055, 0.004161003, -0.037519783, 0.007243851, -0.0018901399, -0.00799856, -0.024460632, 0.008295052, -0.010821977, 0.0101548685, 0.017681736, 0.0082748365, -0.008840868, -0.01722352, 0.013793641, 0.015983643, 0.003409664, 0.041589815, -0.010896101, 0.0017722166, -0.03282981, -0.0031249637, 0.02359811, 0.01058613, -0.0003004935, -0.0016248127, -0.027924204, -0.016360996, -0.0048516956, 0.014905488, 0.0036724643, 0.009063237, 0.030781314, -0.023854172, -0.013706041, 0.0202154, 0.011340839, -0.013604964, 0.013692563, -0.005879312, 0.0024157402, 0.0071764668, -0.01630709, 0.0032850024, 0.003343964, -0.00404308, 0.012095547, -0.009898807, 0.004764096, -0.0030744253, -0.031428207, -0.015821919, -0.0012407202, -0.024447156, -0.011718193, -0.013658872, -0.011542993, -0.0046832343, -0.0051347115, 0.0032277254, 0.004464234, -0.002718971, -0.0057613887, -0.016953982, 0.01419121, 0.0064891432, -0.012668317, 0.0038914643, -0.0018193859, -0.004652911, -0.022910787, 0.026953865, 0.012890686, -0.009993146, -0.0041407878, -0.0024629096, -0.009541669, 0.020687092, -0.015175027, -0.022735586, 0.01485158, -0.029945744, -0.020377122, -0.010714161, 0.008160283, 0.010714161, -0.022439092, 0.010330069, -0.016563151, -0.012836779, 0.017439151, 0.014258595, -0.029891837, 0.00896216, 0.03506698, 0.005936589, 0.02548488, 0.0067283586, 0.035821687, 0.0056569427, 0.005993866, 0.028490236, 0.011320624, 0.021792201, 0.012904163, 0.025377065, 0.007742498, 0.01634752, 0.016590104, 0.01792432, 0.04517468, 0.0029935637, -0.019689798, 0.0025892558, -0.0055524963, -0.0068867127, -0.10786937, -0.030484822, 0.008146806, 0.025916142, -0.0038375566, 0.014918964, -0.0076481593, -0.003224356, -0.0068833437, 0.010559177, -0.0007584986, -0.020242354, -0.021738293, -0.007884006, 0.05703438, 0.0015296319, -0.008706098, -0.01331521, -0.0153637035, 0.03862489, -0.010437884, 0.015121119, -0.0012070278, -0.007553821, -0.0088543445, -0.0060511427, -0.01349041, 0.018220814, -0.018557737, -0.011987732, -0.012358348, -0.0053503425, -0.000028559516, -0.020148015, -0.011866439, -0.004289034, -0.010896101, -0.012412256, 0.011482347, -0.0310239, 0.01813995, 0.03827449, -0.009406899, -0.022991648, 0.009838161, -0.02262777, 0.023678971, 0.013375856, -0.009171053, -0.020094106, -0.01753349, -0.025188388, -0.03291067, 0.0043463106, 0.009689915, -0.00725059, 0.0070147435, 0.0063948045, -0.016940504, 0.032991532, 0.000852416, -0.002139463, -0.028948452, 0.014689857, -0.0056434656, 0.014299026, -0.013827333, -0.007958129, 0.024864942, -0.0134836715, -0.018422967, 0.013908194, -0.021037493, 0.004336203, -0.03911006, -0.012627886, -0.019002475, 0.0013670664, 0.0411316, -0.009514715, -0.031455163, -0.020377122, 0.0021647324, -0.01906986, 0.027843343, 0.018854229, -0.0076616365, 0.0032614178, -0.000111395275, -0.010693946, -0.003945372, 0.022209985, 0.040349938, -0.03870575, 0.008692621, 0.02043103, 0.0026044173, -0.019460691, -0.0032614178, 0.010040315, -0.025026664, -0.0015102588, -0.047142312, 0.043665264, -0.0054985886, -0.007243851, -0.0024831248, 0.00084441405, 0.025956573, -0.010889362, -0.00733819, 0.018759891, -0.011866439, 0.014959396, -0.008578068, 0.0027206559, -0.025067095, -0.012499855, 0.023180325, 0.014865057, 0.012452686, -0.0034905255, 0.0030727407, -0.0048752804, 0.028840637, 0.01718309, -0.010444623, -0.020498415, -0.018921614, 0.012392039, -0.0086387135, -0.0219674, 0.024285434, -0.019083338, -0.013086102, 0.01801866, 0.02029626, -0.025471402, -0.011482347, 0.0011126893, 0.015754534, 0.04846305, -0.026118295, -0.020336691, 0.017075274, -0.007850314, 0.014177733, 0.030862177, 0.007958129, 0.018881183, 0.013375856, 0.001256724, 0.006981051, 0.028705867, -0.0033405947, -0.010309854, -0.020511892, -0.008254621, 0.03695375, 0.0015549011, 0.024730172, 0.0038375566, 0.025740942, 0.024528017, 0.005171773, 0.00013319, 0.009588838, -0.0029733484, -0.004454126, -0.01199447, -0.012135978, -0.02830156, 0.007958129, 0.006859759, 0.009110407, -0.005505327, -0.0067519434, 0.005225681, 0.011772101, 0.014218165, -0.024878418, 0.008955422, 0.00900933, 0.015094165, -0.038867474, 0.018503828, 0.012243793, 0.012843517, -0.020727523, 0.008193975, -0.013935149, 0.014838103, 0.012695271, 0.0004902234, 0.005950066, 0.015929734, -0.006994528, 0.021374416, -0.0093597295, -0.009440592, 0.017749121, 0.004908973, 0.0036926796, -0.005458158, -0.00799856, -0.015646718, -0.008517422, 0.0074729593, -0.012991764, -0.0061623277, -0.00944733, 0.0032529947, 0.013261302, -0.003827449, 0.0026212635, 0.0037769105, -0.0029143868, 0.0013325317, 0.0024797556, -0.005124604, -0.03989172, 0.019568507, 0.0100874845, 0.016280135, -0.0003554541, -0.025565742, 0.012560502, -0.010491792, 0.008631975, -0.00904976, -0.00016856696, 0.006010712, 0.010781546, -0.0020670246, -0.021873062, -0.011859701, -0.00040346567, 0.008665668, 0.016199274, 0.04204803, -0.036091227, 0.032102056, 0.02043103, 0.008402867, 0.013766687, -0.020201921, 0.0054682656, -0.0037027872, -0.01221684, 0.0030036713, -0.027573805, 0.0054076193, 0.001863186, -0.006357743, -0.029137129, -0.0096697, 0.007675113, -0.0153637035, -0.014878534, 0.0060612503, 0.001300524, 0.030484822, 0.003800495, 0.018908137, 0.01840949, -0.00082461984, -0.030808268, 0.014918964, -0.013254563, -0.0036050796, -0.009319299, -0.011920347, -0.0059062657, -0.020714046, -0.0051347115, 0.02737165, 0.005198727, -0.0059601734, -0.027519897, 0.026967343, 0.0007357563, 0.010431146, 0.017654782, -0.019797614, -0.039137013, 0.033099346, 0.0023129785, -0.011017392, -0.0032816331, -0.020848814
                    ],
                    'exact': true,
                    'limit': 10
                }
            }, {
                '$project': {
                    '_id': 0,
                    'plot': 1,
                    'title': 1,
                    'score': {
                        '$meta': 'vectorSearchScore'
                    }
                }
            }
        ];

        // run pipeline
        const result = movies.aggregate(agg);
        // print results
        await result.forEach((doc) => console.dir(JSON.stringify(doc)));


    } finally {
        // Ensures that the client will close when you finish/error
        await client.close();
    }
}
run().catch(console.dir);
